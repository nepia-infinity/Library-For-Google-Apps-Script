<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
        .wrapper {
          max-width: 600px;
          max-height: 350px;
          margin: auto;
        }
        select {
          width: 300px;
          height: auto;
          padding: 10px 5px;
          margin: 10px 0;
        }

        button {
          width: 100px;
          height: auto;
          padding: 8px 0;
          margin: 10px 0;
          float: right;
        }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <label for="pet-select"></label>
      <form id="pet-select" onsubmit="return handleSubmit(this);">
        <select>
          <option value="" name="placeholder">--Please choose an option--</option>
          <script>
            const array = ['予定名を編集する', '詳細欄を編集する', '日時を編集する', '出席者を追加する'];
            for(let i = 0; i < array.length; i++){
              document.write('<option value="' + array[i] + '">' + array[i] + '</option>');
            }
          </script>
        </select>
        <button type="submit">確定する</button>
      </form>
    </div>

    <script>
      function handleSubmit(form) {
        // フォームの送信を阻止
        event.preventDefault();
        
        // フォームデータの取得
        const selectedChoice = form.querySelector('select').value;
        
        // データのバリデーション（例: 必須フィールドが選択されているか確認）
        if (selectedChoice === "") {
          alert("選択肢を選択してください。");
          return false; // ページの再読み込みを阻止
        }
        
        // フォームデータを処理し、他の必要な処理を実行
        
        // フォームデータをサーバーサイドの関数に渡す
        google.script.run.editEvents(selectedChoice); // form を渡すのではなく、選択肢を渡す
        
        // ポップアップメニューを閉じる
        google.script.host.close();
        
        // フォームの送信成功メッセージを表示
        alert("フォームが正常に送信されました。");
        
        return false; // ページの再読み込みを阻止
      }
    </script>
  </body>
</html>
